<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Demo 1 - Beginner</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no" />
    <style>

    </style>
  </head>

  <body>
    <div id="displayText">&nbsp;</div>
    <div id="displayPrice">&nbsp;</div>
    <div id="interactive" class="viewport"><video autoplay="true" preload="auto" src=""></video></div>

    <script src="quagga.js" type="text/javascript"></script>
    <script>
        function barcodeFound(barcode) {
            // This function is called when a barcode is detected
            const values = fetchBarcodeValue(barcode);
            document.querySelector('#displayText').textContent = values.text;
            document.querySelector('#displayPrice').textContent = values.price;
        }


        // You do not need to modify anything beyond this point
        function fetchBarcodeValue(code) {
            const codes = {
                'P81633': { text: 'Phone case', price: 21 },
                '****': { text: 'Need to add more', price: 0 }
            };
            return codes[code] || { text: '', price: 0 };
        }

        var currentCode;
        Quagga.init({
            inputStream: {
                name: 'Barcode',
                type: 'LiveStream'
            },
            decoder: {
                readers: ['code_39_reader']
            }
        }, (err) => {
            if (err) {
                console.error(err);
                return;
            }
            Quagga.start();
        });

        Quagga.onDetected(function(result) {
            if (result.codeResult.code !== currentCode) {
                barcodeFound(result.codeResult.code);
            }
            currentCode = result.codeResult.code;
        });
    </script>
  </body>
</html>
